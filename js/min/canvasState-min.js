function rotate(t){switch(height=Math.floor(tHeight),t[0].color){case"#9013FE":switch(!0){case(1===Math.ceil(t[0].x-t[2].x)||0===Math.ceil(t[0].x-t[2].x))&&Math.ceil(t[0].y-t[2].y)===Math.ceil(tHeight):t[0].x+=left,t[0].y+=up,t[1].x+=left,t[1].y+=down,t[3].x+=right,t[3].y+=up;break;case Math.ceil(t[0].x-t[2].x)===Math.ceil(positionX/10*-1)&&(1===Math.ceil(t[0].y-t[2].y)||0===Math.ceil(t[0].y-t[2].y)):t[0].x+=right,t[0].y+=up,t[1].x+=left,t[1].y+=up,t[3].x+=right,t[3].y+=down;break;case(1===Math.ceil(t[0].x-t[2].x)||0===Math.ceil(t[0].x-t[2].x))&&Math.ceil(t[0].y-t[2].y)===Math.ceil(-1*tHeight):t[0].x+=right,t[0].y+=down,t[1].x+=right,t[1].y+=up,t[3].x+=left,t[3].y+=down;break;case t[2].y===t[2].y:t[0].x+=left,t[0].y+=down,t[1].x+=right,t[1].y+=down,t[3].x+=left,t[3].y+=up}break;case"#4A6EE2":switch(!0){case Math.ceil(t[0].x-t[2].x)===Math.ceil(positionX*-.1)&&Math.ceil(t[0].y-t[2].y)===Math.ceil(tHeight):t[0].x+=0,t[0].y+=2*up,t[1].x+=left,t[1].y+=up,t[3].x+=right,t[3].y+=down;break;case Math.ceil(t[0].x-t[2].x)===Math.ceil(.1*positionX)&&Math.ceil(t[0].y-t[2].y)===Math.ceil(tHeight):t[0].x+=2*left,t[0].y+=0,t[1].x+=left,t[1].y+=down,t[3].x+=right,t[3].y+=up;break;case Math.floor(Math.floor(t[0].x))===Math.floor(Math.floor(t[1].x)):t[0].x+=2*right,t[0].y+=0,t[1].x+=right,t[1].y+=up,t[3].x+=left,t[3].y+=down;break;case Math.ceil(t[0].y-t[2].y)===Math.ceil(-1*tHeight)&&Math.ceil(t[0].x-t[2].x)===Math.ceil(.1*positionX):t[0].x+=0,t[0].y+=2*down,t[1].x+=right,t[1].y+=down,t[3].x+=left,t[3].y+=up}break;case"#7ED321":switch(!0){case Math.floor(t[2].y)===Math.floor(t[1].y):t[0].x+=0,t[0].y+=2*down,t[1].x+=right,t[1].y+=down,t[3].x+=right,t[3].y+=up;break;case Math.floor(t[0].y)===Math.floor(t[1].y):t[0].x+=0,t[0].y+=2*up,t[1].x+=left,t[1].y+=up,t[3].x+=left,t[3].y+=down}break;case"#50E3C2":switch(!0){case Math.floor(t[0].y)!==Math.floor(t[1].y):t[0].x+=2*left,t[0].y+=2*down,t[1].x+=left,t[1].y+=down,t[3].x+=right,t[3].y+=up;break;case Math.floor(t[0].y)===Math.floor(t[1].y):t[0].x+=2*right,t[0].y+=2*up,t[1].x+=right,t[1].y+=up,t[3].x+=left,t[3].y+=down}break;case"#F8E71C":break;case"#D0021B":switch(!0){case Math.floor(t[2].y)!==Math.floor(t[1].y):t[0].x+=2*right,t[0].y+=0,t[1].x+=right,t[1].y+=down,t[3].x+=left,t[3].y+=down;break;case Math.floor(t[0].y)!==Math.floor(t[1].y):t[0].x+=2*left,t[0].y+=0,t[1].x+=left,t[1].y+=up,t[3].x+=right,t[3].y+=up}break;case"#E59512":switch(!0){case Math.ceil(t[0].x-t[2].x)===Math.ceil(-1*positionX/10)&&Math.ceil(t[0].y-t[2].y)===Math.ceil(-1*tHeight):t[0].x+=2*right,t[0].y+=0,t[1].x+=left,t[1].y+=up,t[3].x+=right,t[3].y+=down;break;case Math.ceil(t[0].x-t[2].x)===Math.ceil(positionX/10)&&Math.ceil(t[0].y-t[2].y)===Math.ceil(tHeight):t[0].x+=2*left,t[0].y+=0,t[1].x+=right,t[1].y+=down,t[3].x+=left,t[3].y+=up;break;case Math.ceil(t[0].x-t[2].x)===Math.ceil(positionX/10)&&Math.ceil(t[0].y-t[2].y)===Math.ceil(-1*tHeight):t[0].x+=0,t[0].y+=2*down,t[1].x+=right,t[1].y+=up,t[3].x+=left,t[3].y+=down;break;case Math.ceil(t[0].x-t[2].x)===Math.ceil(-1*positionX/10)&&Math.ceil(t[0].y-t[2].y)===Math.ceil(tHeight):t[0].x+=0,t[0].y+=2*up,t[1].x+=left,t[1].y+=down,t[3].x+=right,t[3].y+=up}}}function clear(){ctx.clearRect(0,0,canvas.width,canvas.height),floor[0].drawFallen(ctx);for(var t=0;t<fallen.length;t++)fallen[t].drawFallen(ctx)}function randomTetrino(){var t=Math.floor(7*Math.random()),e;switch(!0){case 0===t:return e=tBlock;case 1===t:return e=jBlock;case 2===t:return e=sBlock;case 3===t:return e=iBlock;case 4===t:return e=oBlock;case 5===t:return e=zBlock;case 6===t:return e=lBlock}}function next(){randomRotate=Math.floor(3*Math.random()),tetrino=randomTetrino();var t=document.getElementById("next");t.innerHTML="<img src='images/"+tetrino.name+".png' alt='"+tetrino.name+"'>"}function stats(t){if(t){t.number++;var e=document.getElementById(t.name);e.innerHTML=t.number}}function newRect(){var t=document.getElementById("start");t.addEventListener("click",function(t){t.preventDefault()}),t.innerHTML=" ";for(var e=0;e<tetrino.shape[0].length;e++)addShape([tetrino.shape[0][e],tetrino.name]);stats(tetrino),next()}function checkLine(t,e){fallen=fallen.sort(function(t,e){return e.y-t.y}),count=0,index=0;for(var i=0;i<fallen.length;i++)if(fallen[i].y<=e&&fallen[i].y>t&&fallen[i].x>0&&"floor"!==fallen[i].name){if(deleteArray.push(fallen[i]),count++,10===count)return count}else index++,deleteArray.length=0}function checkWin(){for(var t=0;20>t;t++){var e=checkLine(tHeight*t,tHeight*(t+1));if(e>=10){for(var i=t,n=fallen.indexOf(deleteArray[9]);n<fallen.length;n++)fallen[n].y+=Math.ceil(tHeight);for(var o=0;o<deleteArray.length;o++)fallen.splice(fallen.indexOf(deleteArray[o]),1),window.console.log("Spliced at "+o);deleteArray.length=0,score+=200,lines++,window.console.log("Spliced these values: "+parseInt(index-10)+" to "+index),document.getElementById("lines").innerHTML=lines,document.getElementById("score").innerHTML=score}}}function drawing(){draw(canvas)}var tWidth=Math.floor((window.innerWidth-1)/10),tHeight=window.innerHeight/20,Rectangle=function(t,e,i,n,o){this.name=0,this.x=t,this.y=e,this.w=n,this.h=o,this.ctx=document.getElementById("canvas").getContext("2d"),this.hit=!1,(void 0===n||void 0===o)&&(this.w=tWidth-4,this.h=tHeight),this.color=i,this.drawFallen=function(){this.ctx.fillStyle=this.color,this.ctx.lineWidth="3",this.ctx.strokeStyle="black",this.ctx.strokeRect(this.x,this.y,this.w,this.h),this.ctx.fillRect(this.x,this.y,this.w,this.h)},this.draw=function(){var t=this.y;t+=tHeight/18,this.ctx.fillStyle=this.color,this.ctx.lineWidth="3",this.ctx.strokeStyle="black",this.ctx.strokeRect(this.x,t,this.w,this.h),this.ctx.fillRect(this.x,t,this.w,this.h)},this.drop=function(){var t=this.y;t+=tHeight/20,this.y=t}};Rectangle.prototype.contains=function(t,e){return t>=this.x&&t<=this.x+this.w&&e>=this.y&&e<=this.y+this.h?!0:!1},Rectangle.prototype.intersects=function(t){return this.contains(t.x,t.y)||this.contains(t.x+t.w,t.y)||this.contains(t.x,t.y+t.h)||this.contains(t.x+t.w,t.y+t.h)?!0:t.contains(this.x,this.y)||t.contains(this.x+this.w,this.y)||t.contains(this.x,this.y+this.h)||t.contains(this.x+this.w,this.y+this.h)?!0:!1};var positionX=window.innerWidth,tBlock={name:"tBlock",color:"#9013FE",number:1e3,shape:[[new Rectangle(.4*positionX,tHeight,"#9013FE"),new Rectangle(.3*positionX,2*tHeight,"#9013FE"),new Rectangle(.4*positionX,2*tHeight,"#9013FE"),new Rectangle(.5*positionX,2*tHeight,"#9013FE")]]},jBlock={name:"jBlock",color:"#4A6EE2",number:1e3,shape:[[new Rectangle(.3*positionX,tHeight,"#4A6EE2"),new Rectangle(.3*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.4*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.5*positionX,2*tHeight,"#4A6EE2")]]},sBlock={name:"sBlock",color:"#7ED321",number:1e3,shape:[[new Rectangle(.3*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,tHeight,"#7ED321"),new Rectangle(.5*positionX,1*tHeight,"#7ED321")]]},iBlock={name:"iBlock",color:"#50E3C2",number:1e3,shape:[[new Rectangle(.3*positionX,tHeight,"#50E3C2",tWidth-5,tHeight),new Rectangle(.4*positionX,tHeight,"#50E3C2",tWidth-5,tHeight),new Rectangle(.5*positionX,tHeight,"#50E3C2",tWidth-5,tHeight),new Rectangle(.6*positionX,tHeight,"#50E3C2",tWidth-5,tHeight)]]},oBlock={name:"oBlock",color:"#F8E71C",number:1e3,shape:[[new Rectangle(.4*positionX,tHeight,"#F8E71C"),new Rectangle(.5*positionX,tHeight,"#F8E71C"),new Rectangle(.4*positionX,2*tHeight,"#F8E71C"),new Rectangle(.5*positionX,2*tHeight,"#F8E71C")]]},zBlock={name:"zBlock",color:"#D0021B",number:1e3,shape:[[new Rectangle(.3*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,2*tHeight,"#D0021B"),new Rectangle(.5*positionX,2*tHeight,"#D0021B")]]},lBlock={name:"lBlock",color:"#E59512",number:1e3,shape:[[new Rectangle(.5*positionX,tHeight,"#E59512"),new Rectangle(.3*positionX,2*tHeight,"#E59512"),new Rectangle(.4*positionX,2*tHeight,"#E59512"),new Rectangle(.5*positionX,2*tHeight,"#E59512")]]},up=-tHeight,down=tHeight,left=.1*-positionX,right=.1*positionX,difference,height,canvas=document.getElementById("canvas");canvas.height=window.innerHeight,canvas.width=window.innerWidth,canvas.style.width="45%",canvas.style.height="90%";var ctx=canvas.getContext("2d"),shapes=[],fallen=[new Rectangle(0,27*tHeight,"black",canvas.width,tHeight)],floor=[new Rectangle(0,20*tHeight,"black",canvas.width,tHeight)],moveLeft=function(t){for(var e=0;e<t.length;e++)t[e].x-=tWidth},moveRight=function(t){for(var e=0;e<t.length;e++)t[e].x+=tWidth},moveDown=function(t){for(var e=0;e<t.length;e++)t[e].y+=tHeight},keyControls=function(t){document.onkeydown=function(e){switch(e=e||window.event,e.which||e.keyCode){case 65:moveLeft(t);break;case 37:moveLeft(t);break;case 87:rotate(t);break;case 38:rotate(t);break;case 68:moveRight(t);break;case 39:moveRight(t);break;case 82:moveDown(t);break;case 40:moveDown(t);break;default:window.console.log(e.which),window.console.log(e.keyCode)}}},addShape=function(t){shapes.push(t[0])},randomRotate,tetrino=randomTetrino(),score=0,count=0,index=-1,lines=0,deleteArray=[],draw=function(){if(clear(),shapes.length>0)for(var t=0;t<shapes.length;t++){for(var e=0;e<fallen.length;e++)if(shapes[t].intersects(fallen[e])||shapes[t].intersects(floor[0]))return shapes[t].intersects(fallen[e])?shapes[t].y=Math.floor(fallen[e].y)-Math.floor(fallen[e].h):shapes[t].y=Math.floor(floor[0].y)-Math.floor(tHeight),shapes[t].hit=!0,shapes[0].y=Math.ceil(shapes[0].y),shapes[1].y=Math.ceil(shapes[1].y),shapes[2].y=Math.ceil(shapes[2].y),shapes[3].y=Math.ceil(shapes[3].y),fallen.push(shapes[0]),fallen.push(shapes[1]),fallen.push(shapes[2]),fallen.push(shapes[3]),shapes.splice(0,4),checkWin(),fallen[e].y<60?(window.alert("Game Over"),fallen.length=0,fallen.length):(tBlock.shape=[[new Rectangle(.4*positionX,tHeight,"#9013FE"),new Rectangle(.3*positionX,2*tHeight,"#9013FE"),new Rectangle(.4*positionX,2*tHeight,"#9013FE"),new Rectangle(.5*positionX,2*tHeight,"#9013FE")]],jBlock.shape=[[new Rectangle(.3*positionX,tHeight,"#4A6EE2"),new Rectangle(.3*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.4*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.5*positionX,2*tHeight,"#4A6EE2")]],sBlock.shape=[[new Rectangle(.3*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,tHeight,"#7ED321"),new Rectangle(.5*positionX,1*tHeight,"#7ED321")]],iBlock.shape=[[new Rectangle(.3*positionX,tHeight,"#50E3C2",tWidth-5,tHeight),new Rectangle(.4*positionX,tHeight,"#50E3C2",tWidth-5,tHeight),new Rectangle(.5*positionX,tHeight,"#50E3C2",tWidth-5,tHeight),new Rectangle(.6*positionX,tHeight,"#50E3C2",tWidth-5,tHeight)]],oBlock.shape=[[new Rectangle(.4*positionX,tHeight,"#F8E71C"),new Rectangle(.5*positionX,tHeight,"#F8E71C"),new Rectangle(.4*positionX,2*tHeight,"#F8E71C"),new Rectangle(.5*positionX,2*tHeight,"#F8E71C")]],zBlock.shape=[[new Rectangle(.3*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,2*tHeight,"#D0021B"),new Rectangle(.5*positionX,2*tHeight,"#D0021B")]],lBlock.shape=[[new Rectangle(.5*positionX,tHeight,"#E59512"),new Rectangle(.3*positionX,2*tHeight,"#E59512"),new Rectangle(.4*positionX,2*tHeight,"#E59512"),new Rectangle(.5*positionX,2*tHeight,"#E59512")]],void setInterval(newRect(),400));this.hit||(keyControls(shapes),shapes[t].draw(),shapes[t].drop())}},myState=canvas;myState.interval=16.5,setInterval(drawing,myState.interval);