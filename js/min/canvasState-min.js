function rotate(e){switch(difference=e[2].y-e[0].y,difference=Math.floor(difference),height=Math.floor(tHeight),e[0].color){case"#9013FE":switch(!0){case Math.floor(e[0].x)-Math.floor(e[2].x)===Math.floor(left):window.console.log("tBlock.shape[3]"),e[0].x+=right,e[0].y+=up,e[1].x+=left,e[1].y+=up,e[3].x+=right,e[3].y+=down;break;case difference===height:window.console.log("tBlock.shape[0]"),e[0].x+=right,e[0].y+=down,e[1].x+=right,e[1].y+=up,e[3].x+=left,e[3].y+=down,window.console.log("finished");break;case 0===difference:window.console.log("tBlock.shape[1]"),e[0].x+=left,e[0].y+=down,e[1].x+=right,e[1].y+=down,e[3].x+=left,e[3].y+=up;break;case difference===-1+-1*height:window.console.log("tBlock.shape[2]"),e[0].x+=left,e[0].y+=up,e[1].x+=left,e[1].y+=down,e[3].x+=right,e[3].y+=up;break;default:window.console.log("tBlock error")}break;case"#4A6EE2":switch(!0){case Math.floor(e[3].y)-Math.floor(e[1].y)===-2*(height+1):window.console.log("jBlock.shape[3]"),e[0].x+=0,e[0].y+=2*up,e[1].x+=left,e[1].y+=up,e[3].x+=right,e[3].y+=down;break;case Math.floor(e[0].y)===Math.floor(e[1].y):window.console.log("jBlock.shape[1]"),e[0].x+=0,e[0].y+=2*down,e[1].x+=right,e[1].y+=down,e[3].x+=left,e[3].y+=up;break;case difference===height:window.console.log("jBlock.shape[0]"),e[0].x+=2*right,e[0].y+=0,e[1].x+=right,e[1].y+=up,e[3].x+=left,e[3].y+=down,window.console.log("finished");break;case difference===-1+-1*height:window.console.log("jBlock.shape[2]"),e[0].x+=2*left,e[0].y+=0,e[1].x+=left,e[1].y+=down,e[3].x+=right,e[3].y+=up;break;default:window.console.log("jBlock error")}break;case"#7ED321":switch(window.console.log(Math.floor(e[0].x)-Math.floor(e[2].x)),window.console.log(left),!0){case Math.floor(e[2].y)===Math.floor(e[1].y):window.console.log("sBlock.shape[3]"),e[0].x+=0,e[0].y+=2*down,e[1].x+=right,e[1].y+=down,e[3].x+=right,e[3].y+=up;break;case Math.floor(e[0].y)===Math.floor(e[1].y):window.console.log("sBlock.shape[1]"),e[0].x+=0,e[0].y+=2*up,e[1].x+=left,e[1].y+=up,e[3].x+=left,e[3].y+=down;break;default:window.console.log("sBlock error")}break;case"#50E3C2":switch(!0){case Math.floor(e[0].y)!==Math.floor(e[1].y):window.console.log("iBlock.shape[2]"),e[0].x+=2*left,e[0].y+=2*down,e[1].x+=left,e[1].y+=down,e[3].x+=right,e[3].y+=up;break;case Math.floor(e[0].y)===Math.floor(e[1].y):window.console.log("iBlock.shape[1]"),e[0].x+=2*right,e[0].y+=2*up,e[1].x+=right,e[1].y+=up,e[3].x+=left,e[3].y+=down;break;default:window.console.log("iBlock error")}break;case"#F8E71C":break;case"#D0021B":switch(!0){case Math.floor(e[2].y)!==Math.floor(e[1].y):window.console.log("zBlock.shape[2]"),e[0].x+=2*right,e[0].y+=0,e[1].x+=right,e[1].y+=down,e[3].x+=left,e[3].y+=down;break;case Math.floor(e[0].y)!==Math.floor(e[1].y):window.console.log("zBlock.shape[1]"),e[0].x+=2*left,e[0].y+=0,e[1].x+=left,e[1].y+=up,e[3].x+=right,e[3].y+=up;break;default:window.console.log("zBlock error")}break;case"#E59512":switch(!0){case Math.floor(e[3].y)-Math.floor(e[1].y)===-2*(height+1):window.console.log("lBlock.shape[3]"),e[0].x+=0,e[0].y+=2*up,e[1].x+=left,e[1].y+=up,e[3].x+=right,e[3].y+=down;break;case Math.floor(e[0].y)===Math.floor(e[1].y):window.console.log("lBlock.shape[1]"),e[0].x+=0,e[0].y+=2*down,e[1].x+=right,e[1].y+=down,e[3].x+=left,e[3].y+=up;break;case difference===height:window.console.log("jBlock.shape[0]"),e[0].x+=2*right,e[0].y+=0,e[1].x+=right,e[1].y+=up,e[3].x+=left,e[3].y+=down,window.console.log("finished");break;case difference===-1+-1*height:window.console.log("jBlock.shape[2]"),e[0].x+=2*left,e[0].y+=0,e[1].x+=left,e[1].y+=down,e[3].x+=right,e[3].y+=up;break;default:window.console.log("lBlock error")}break;default:console.log("something went wrong")}}function checkLine(e,t){fallen=fallen.sort(function(e,t){return t.y-e.y}),count=0,index=-1;for(var o=3;o<fallen.length;o++)fallen[o].y<=t&&fallen[o].y>=e?count++:index++;return count}function checkWin(){for(var e=1;20>e;e++){var t=checkLine(tHeight*e,tHeight*(e+1));if(t>=10){window.console.log("SCORE!"),score+=200,lines++,fallen.splice(index,10),document.getElementById("lines").innerHTML=lines,document.getElementById("score").innerHTML=score;for(var o=index+10;o<fallen.length;o++)fallen[o].y-=tHeight}window.console.log("count: "+count),window.console.log("Working")}}function clear(){ctx.clearRect(0,0,canvas.width,canvas.height),fallen[0].drawFallen(ctx),fallen[1].drawFallen(ctx),fallen[2].drawFallen(ctx);for(var e=0;e<fallen.length;e++)fallen[e].color="purple",fallen[e].drawFallen(ctx)}function randomTetrino(){var e=Math.floor(7*Math.random()),t;switch(!0){case 0===e:return t=tBlock;case 1===e:return t=jBlock;case 2===e:return t=sBlock;case 3===e:return t=iBlock;case 4===e:return t=oBlock;case 5===e:return t=zBlock;case 6===e:return t=lBlock}}function next(){randomRotate=Math.floor(3*Math.random()),tetrino=randomTetrino();var e=document.getElementById("next");console.log(tetrino.name),e.innerHTML="<img src='images/"+tetrino.name+".png' alt='"+tetrino.name+"'>"}function stats(e){if(e){e.number++;var t=document.getElementById(e.name);t.innerHTML=e.number}}function newRect(){var e=document.getElementById("start");e.style.display="none";for(var t=0;t<tetrino.shape[0].length;t++)addShape([tetrino.shape[0][t],tetrino.name]);stats(tetrino),next()}function devRect(e){for(var t=0;t<e.length;t++)addShape(e[t])}function drawing(){draw(canvas)}var tWidth=(window.innerWidth-1)/10,tHeight=(window.innerHeight-1)/20,Rectangle=function(e,t,o,n,i){this.name=0,this.x=e,this.y=t,this.w=n,this.h=i,this.ctx=document.getElementById("canvas").getContext("2d"),this.hit=!1,(void 0===n||void 0===i)&&(this.w=tWidth-2,this.h=tHeight),this.color=o,this.drawFallen=function(){this.ctx.fillStyle=this.color,this.ctx.lineWidth="3",this.ctx.strokeStyle="black",this.ctx.strokeRect(this.x,this.y,this.w,this.h),this.ctx.fillRect(this.x,this.y,this.w,this.h)},this.draw=function(){var e=this.y;e+=tHeight/18,this.ctx.fillStyle=this.color,this.ctx.lineWidth="3",this.ctx.strokeStyle="black",this.ctx.strokeRect(this.x,e,this.w,this.h),this.ctx.fillRect(this.x,e,this.w,this.h)},this.drop=function(){var e=this.y;e+=tHeight/20,this.y=e}};Rectangle.prototype.contains=function(e,t){return e>=this.x&&e<=this.x+this.w&&t>=this.y&&t<=this.y+this.h?!0:!1},Rectangle.prototype.intersects=function(e){return this.contains(e.x,e.y)||this.contains(e.x+e.w,e.y)||this.contains(e.x,e.y+e.h)||this.contains(e.x+e.w,e.y+e.h)?!0:e.contains(this.x,this.y)||e.contains(this.x+this.w,this.y)||e.contains(this.x,this.y+this.h)||e.contains(this.x+this.w,this.y+this.h)?!0:!1};var positionX=window.innerWidth,tBlock={name:"tBlock",color:"#9013FE",number:1e3,shape:[[new Rectangle(.4*positionX,tHeight,"#9013FE"),new Rectangle(.3*positionX,2*tHeight,"#9013FE"),new Rectangle(.4*positionX,2*tHeight,"#9013FE"),new Rectangle(.5*positionX,2*tHeight,"#9013FE")]]},jBlock={name:"jBlock",color:"#4A6EE2",number:1e3,shape:[[new Rectangle(.3*positionX,tHeight,"#4A6EE2"),new Rectangle(.3*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.4*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.5*positionX,2*tHeight,"#4A6EE2")]]},sBlock={name:"sBlock",color:"#7ED321",number:1e3,shape:[[new Rectangle(.3*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,tHeight,"#7ED321"),new Rectangle(.5*positionX,1*tHeight,"#7ED321")]]},iBlock={name:"iBlock",color:"#50E3C2",number:1e3,shape:[[new Rectangle(.3*positionX,tHeight,"#50E3C2"),new Rectangle(.4*positionX,tHeight,"#50E3C2"),new Rectangle(.5*positionX,tHeight,"#50E3C2"),new Rectangle(.6*positionX,tHeight,"#50E3C2")]]},oBlock={name:"oBlock",color:"#F8E71C",number:1e3,shape:[[new Rectangle(.4*positionX,tHeight,"#F8E71C"),new Rectangle(.5*positionX,tHeight,"#F8E71C"),new Rectangle(.4*positionX,2*tHeight,"#F8E71C"),new Rectangle(.5*positionX,2*tHeight,"#F8E71C")]]},zBlock={name:"zBlock",color:"#D0021B",number:1e3,shape:[[new Rectangle(.3*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,2*tHeight,"#D0021B"),new Rectangle(.5*positionX,2*tHeight,"#D0021B")]]},lBlock={name:"lBlock",color:"#E59512",number:1e3,shape:[[new Rectangle(.5*positionX,tHeight,"#E59512"),new Rectangle(.3*positionX,2*tHeight,"#E59512"),new Rectangle(.4*positionX,2*tHeight,"#E59512"),new Rectangle(.5*positionX,2*tHeight,"#E59512")]]};window.console.log("hello from rotate.js");var up=-tHeight,down=tHeight,left=.1*-positionX,right=.1*positionX,difference,height,score=0,count=0,index=-1,lines=0,canvas=document.getElementById("canvas");canvas.height=window.innerHeight,canvas.width=window.innerWidth,canvas.style.width="45%",canvas.style.height="90%";var ctx=canvas.getContext("2d"),shapes=[],fallen=[new Rectangle(0,canvas.height,"black",canvas.width,tHeight),new Rectangle(canvas.width,tHeight,"black",100,canvas.height),new Rectangle(-10,tHeight,"black",10,canvas.height)],moveLeft=function(e){for(var t=0;t<e.length;t++)e[t].x-=tWidth},moveRight=function(e){for(var t=0;t<e.length;t++)e[t].x+=tWidth},moveDown=function(e){for(var t=0;t<e.length;t++)e[t].y+=tHeight},keyControls=function(e){document.onkeydown=function(t){switch(t=t||window.event,t.which||t.keyCode){case 65:window.console.log("left"),moveLeft(e);break;case 37:window.console.log("left"),moveLeft(e);break;case 87:window.console.log("Up"),rotate(e);break;case 38:rotate(e);break;case 68:window.console.log("Right"),moveRight(e);break;case 39:window.console.log(e),window.console.log("tWidth "+tWidth),moveRight(e);break;case 82:window.console.log("Down"),moveDown(e);break;case 40:window.console.log("Down"),moveDown(e);break;default:window.console.log(t.which),window.console.log(t.keyCode)}}},addShape=function(e){shapes.push(e[0])},randomRotate,tetrino=randomTetrino(),draw=function(e){if(clear(),shapes.length>0)for(var t=0;t<shapes.length;t++){for(var o=0;o<fallen.length;o++)if(shapes[t].intersects(fallen[o]))return shapes[t].y=Math.floor(fallen[o].y)-Math.floor(fallen[o].h),shapes[t].hit=!0,shapes[0].y=Math.floor(shapes[0].y),shapes[1].y=Math.floor(shapes[1].y),shapes[2].y=Math.floor(shapes[2].y),shapes[3].y=Math.floor(shapes[3].y),fallen.push(shapes[0]),fallen.push(shapes[1]),fallen.push(shapes[2]),fallen.push(shapes[3]),shapes.splice(0,4),checkWin(),window.console.log(fallen[o].y),fallen[o].y<60?(alert("Game Over"),console.log("DELETE"),fallen.length=3,fallen.length):(tBlock.shape=[[new Rectangle(.4*positionX,tHeight,"#9013FE"),new Rectangle(.3*positionX,2*tHeight,"#9013FE"),new Rectangle(.4*positionX,2*tHeight,"#9013FE"),new Rectangle(.5*positionX,2*tHeight,"#9013FE")]],jBlock.shape=[[new Rectangle(.3*positionX,tHeight,"#4A6EE2"),new Rectangle(.3*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.4*positionX,2*tHeight,"#4A6EE2"),new Rectangle(.5*positionX,2*tHeight,"#4A6EE2")]],sBlock.shape=[[new Rectangle(.3*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,2*tHeight,"#7ED321"),new Rectangle(.4*positionX,tHeight,"#7ED321"),new Rectangle(.5*positionX,1*tHeight,"#7ED321")]],iBlock.shape=[[new Rectangle(.3*positionX,tHeight,"#50E3C2"),new Rectangle(.4*positionX,tHeight,"#50E3C2"),new Rectangle(.5*positionX,tHeight,"#50E3C2"),new Rectangle(.6*positionX,tHeight,"#50E3C2")]],oBlock.shape=[[new Rectangle(.4*positionX,tHeight,"#F8E71C"),new Rectangle(.5*positionX,tHeight,"#F8E71C"),new Rectangle(.4*positionX,2*tHeight,"#F8E71C"),new Rectangle(.5*positionX,2*tHeight,"#F8E71C")]],zBlock.shape=[[new Rectangle(.3*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,tHeight,"#D0021B"),new Rectangle(.4*positionX,2*tHeight,"#D0021B"),new Rectangle(.5*positionX,2*tHeight,"#D0021B")]],lBlock.shape=[[new Rectangle(.3*positionX,tHeight,"#50E3C2"),new Rectangle(.4*positionX,tHeight,"#50E3C2"),new Rectangle(.5*positionX,tHeight,"#50E3C2"),new Rectangle(.6*positionX,tHeight,"#50E3C2")]],void newRect());this.hit||(keyControls(shapes),shapes[t].draw(),shapes[t].drop())}},myState=canvas;myState.interval=16.5,setInterval(drawing,myState.interval);